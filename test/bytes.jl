using Lava, Test
using SPIRV: Vec
using Lava: extract_bytes

struct SomeDataStruct
  vec::Vec{2,Int64}
  byte::UInt8
  val::UInt64
end

@testset "Byte extraction" begin
  val = 43
  @test extract_bytes(val) == [0x2b, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
  val = 0xff
  @test extract_bytes(val) == [0xff]
  val = [43, 44]
  @test extract_bytes(val) == [0x2b, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x2c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
  val = Vec(43, 44)
  @test extract_bytes(val) == [0x2b, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x2c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
  val = SomeDataStruct(Vec(43, 44), 0x12, typemax(UInt64))
  @test extract_bytes(val) == [0x2b, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x2c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x12, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff]
end;
